% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/go_workflow.R
\name{run_go_enrichment_workflow}
\alias{run_go_enrichment_workflow}
\title{GO Enrichment Workflow Functions}
\usage{
run_go_enrichment_workflow(
  con,
  candidate_vcf_file,
  background_file_id = NULL,
  blast_param_id = NULL,
  ontologies = c("BP", "MF", "CC"),
  min_genes = 5,
  max_genes = 500,
  significance_threshold = 0.05,
  method = "clusterprofiler",
  store_results = TRUE,
  create_plots = TRUE,
  verbose = TRUE
)
}
\arguments{
\item{con}{Database connection object}

\item{candidate_vcf_file}{Character. Path to candidate VCF file}

\item{background_file_id}{Integer. File ID of background dataset (or NULL to auto-detect)}

\item{blast_param_id}{Integer. Optional. Specific BLAST run ID to use for both datasets.
If NULL, uses all available annotations. Default is NULL.}

\item{ontologies}{Character vector. GO ontologies to test: c("BP", "MF", "CC"). Default is c("BP", "MF", "CC")}

\item{min_genes}{Integer. Minimum genes for GO term testing. Default is 5}

\item{max_genes}{Integer. Maximum genes for GO term testing. Default is 500}

\item{significance_threshold}{Numeric. FDR threshold for significance. Default is 0.05}

\item{store_results}{Logical. Store results in database. Default is TRUE}

\item{create_plots}{Logical. Generate visualization plots. Default is TRUE}

\item{verbose}{Logical. Print progress information. Default is TRUE}
}
\value{
List containing all analysis results, plots, and summary tables
}
\description{
High-level wrapper functions for complete GO enrichment workflows
}
\details{
Complete GO enrichment analysis workflow

This function performs a complete GO enrichment workflow:
\enumerate{
\item Import candidate loci file
\item Link to existing annotations
\item Extract GO terms for both datasets (optionally filtered by BLAST run)
\item Perform enrichment testing for specified ontologies
\item Create visualizations
\item Store results in database (optional)
}

When blast_param_id is specified, only annotations from that specific BLAST run
are used for both candidate and background datasets, ensuring methodological
consistency and enabling comparison of different annotation strategies.
}
\examples{
\dontrun{
con <- connect_funseq_db("analysis.db")

# Use all available annotations and all ontologies (default behavior)
results <- run_go_enrichment_workflow(con, "candidates.vcf")

# Use custom significance threshold (e.g., 0.1 for more lenient)
results_lenient <- run_go_enrichment_workflow(con, "candidates.vcf", significance_threshold = 0.1)

# Use only specific ontologies and stricter threshold
results_strict <- run_go_enrichment_workflow(con, "candidates.vcf", 
                                            ontologies = c("BP", "MF"), 
                                            significance_threshold = 0.01)

# Use only ORF-based annotations
results_orf <- run_go_enrichment_workflow(con, "candidates.vcf", blast_param_id = 1)

print(results_lenient$summary)
print(results_lenient$plots$BP_bubble)
}

}
