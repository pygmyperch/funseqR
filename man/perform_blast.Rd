% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/perform_blast.R
\name{perform_blast}
\alias{perform_blast}
\title{Perform BLAST Search}
\usage{
perform_blast(
  sequences,
  db_path,
  db_name,
  blast_type = c("blastn", "blastx"),
  e_value = 1e-05,
  max_hits = 5,
  threads = 1,
  output_base = "blast_output"
)
}
\arguments{
\item{sequences}{A Biostrings::DNAStringSet object containing the query sequences.}

\item{db_path}{Character string specifying the path to the BLAST database.}

\item{db_name}{Character string specifying the name of the BLAST database.}

\item{blast_type}{Character string specifying the type of BLAST search.
Must be either "blastn" or "blastx".}

\item{e_value}{Numeric value specifying the E-value threshold for hits.
Default is 1e-5.}

\item{max_hits}{Integer specifying the maximum number of hits to return
per query. Default is 5.}

\item{threads}{Integer specifying the number of CPU threads to use.
Default is 1.}

\item{output_base}{Character string specifying the base name for output files.
Default is "blast_output".}
}
\value{
A list containing two elements:
\item{results}{A data frame of BLAST results, or NULL if no hits found.}
\item{metadata}{A list containing metadata about the BLAST search,
including parameters used, database information, and file paths.}
}
\description{
This function performs a BLAST search using BLAST+. It supports
both blastn and blastx searches against one of several specified databases.
}
\details{
This function performs the following steps:
\enumerate{
\item Checks if BLAST+ is installed and if the specified database exists.
\item Writes query sequences to a FASTA file.
\item Constructs and executes the BLAST command.
\item Parses the BLAST output and converts it to a data frame.
\item Saves the results and metadata as a .RData file.
}

The function creates several output files:
\itemize{
\item A FASTA file containing the query sequences
\item A text file containing the raw BLAST output
\item A .RData file containing the parsed results and metadata
}
}
\note{
\itemize{
\item This function requires BLAST+ to be installed and in the system PATH.
\item The specified BLAST database must exist and have the necessary files
(.nhr, .nin, .nsq for blastn; .phr, .pin, .psq for blastx).
\item Large sequences or databases may require significant time and computational resources.
}
}
\examples{
\dontrun{
library(Biostrings)
sequences <- DNAStringSet(c("ATGCATGC", "GCATGCAT"))
blast_results <- perform_blast(
  sequences = sequences,
  db_path = "/path/to/blast/db",
  db_name = "nr",
  blast_type = "blastx",
  e_value = 1e-10,
  max_hits = 10,
  threads = 4,
  output_base = "my_blast_search"
)
}

}
