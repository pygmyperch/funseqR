% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/enrichment_analysis.R
\name{run_go_enrichment_analysis}
\alias{run_go_enrichment_analysis}
\title{Run GO Enrichment Analysis on Processed Annotations}
\usage{
run_go_enrichment_analysis(
  annotations,
  candidate_loci,
  ontologies = c("BP", "MF", "CC"),
  min_genes = 3,
  max_genes = 500,
  max_terms_tested = NULL,
  significance_threshold = 0.05,
  verbose = TRUE
)
}
\arguments{
\item{annotations}{Data frame from process_annotations() containing GO annotations}

\item{candidate_loci}{Data frame with coordinates (BED or VCF format), or vector of locus_ids.
Accepts: (1) BED format with 'chrom' (or 'chromosome'), 'start', 'end' columns,
(2) VCF format with 'chrom' (or 'chromosome'), 'position' columns, or (3) vector of locus_ids}

\item{ontologies}{Character vector. GO ontologies to test: c("BP", "MF", "CC"). Default is c("BP", "MF", "CC")}

\item{min_genes}{Integer. Minimum genes for GO term testing. Default is 3
(inclusive approach - researchers can evaluate biological relevance of smaller terms)}

\item{max_genes}{Integer. Maximum genes for GO term testing. Default is 500
(excludes overly broad terms like 'biological process')}

\item{max_terms_tested}{Integer. Maximum number of terms to test per ontology.
Default is NULL (test all terms). Set to 20 to match legacy behavior with less stringent FDR correction.}

\item{significance_threshold}{Numeric. FDR threshold for significance. Default is 0.05}

\item{verbose}{Logical. Print progress information. Default is TRUE}
}
\value{
List containing enrichment results for each ontology tested
}
\description{
Performs GO enrichment analysis using candidate loci and processed annotation data.
This is a simplified interface that works with the standardized output from process_annotations().
}
\details{
This function automatically maps ontology codes from the analysis interface ("BP", "MF", "CC")
to the database storage format ("P", "F", "C") used in GO term categories.
}
\examples{
\dontrun{
# Process annotations first
annotations <- process_annotations(con, include = c("GO", "KEGG"))

# Using VCF format
candidates_vcf <- data.frame(chromosome = c("LG1", "LG2"), position = c(12345, 67890))
go_results <- run_go_enrichment_analysis(annotations, candidates_vcf)

# Using BED format (from import_candidate_loci)
candidates <- import_candidate_loci(con, candidate_vcf_file, background_file_id = 1)
go_results <- run_go_enrichment_analysis(annotations, candidates$bed_file)

# Using locus IDs directly
go_results <- run_go_enrichment_analysis(annotations, c("1_LG1_12345", "1_LG2_67890"))

# For legacy compatibility (test only first 20 terms per ontology)
go_results_legacy <- run_go_enrichment_analysis(annotations, candidates$bed_file, max_terms_tested = 20)

print(go_results$BP)
}

}
