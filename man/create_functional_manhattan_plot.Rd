% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/functional_visualization.R
\name{create_functional_manhattan_plot}
\alias{create_functional_manhattan_plot}
\title{Create functional Manhattan plot}
\usage{
create_functional_manhattan_plot(
  con,
  enrichment_results,
  candidate_file_id,
  gea_results,
  y_metric = "p_value",
  y_transform = "-log10",
  significance_threshold = 0.05,
  label_terms = "significant",
  max_labels = 20,
  consolidate_scaffolds = TRUE,
  color_by = "go_category",
  point_size_by = "fold_enrichment",
  position_tolerance = 0,
  title = NULL,
  theme_function = ggplot2::theme_minimal
)
}
\arguments{
\item{con}{Database connection object}

\item{enrichment_results}{Data frame or list of GO enrichment results}

\item{candidate_file_id}{Integer. File ID of candidate dataset}

\item{gea_results}{Data frame with GEA results containing chromosome, position, and metric columns}

\item{y_metric}{Character. Column name in gea_results to use for y-axis. Default is "p_value"}

\item{y_transform}{Character. Transformation for y-axis: "-log10", "log10", "identity", etc. Default is "-log10"}

\item{significance_threshold}{Numeric. FDR threshold for enrichment significance. Default is 0.05}

\item{label_terms}{Character. Which terms to label: "significant", "top", or "none". Default is "significant"}

\item{max_labels}{Integer. Maximum number of labels to show. Default is 20}

\item{consolidate_scaffolds}{Logical. Use consolidated chromosome names. Default is TRUE}

\item{color_by}{Character. Color points by: "go_category", "fold_enrichment", or "significance". Default is "go_category"}

\item{point_size_by}{Character. Size points by: "fold_enrichment", "significance", or NULL. Default is "fold_enrichment"}

\item{position_tolerance}{Integer. Tolerance for matching genomic positions (bp). Default is 0}

\item{title}{Character. Plot title. Default is auto-generated}

\item{theme_function}{Function. ggplot2 theme function. Default is theme_minimal}
}
\value{
ggplot object
}
\description{
Create a Manhattan plot that displays genomic positions colored and labeled by
functional enrichment results, with user-provided GEA statistics on the y-axis.
This visualization links functional predictions back to genomic evidence.
}
\details{
This function creates a Manhattan plot that combines genomic positions (x-axis)
with user-provided GEA statistics (y-axis), while highlighting and labeling
points based on functional enrichment results. This enables visual validation
that functionally enriched loci are also those with strong environmental
associations.

The function automatically handles:
\itemize{
\item Chromosome consolidation for clean visualization
\item Intelligent label placement to avoid overcrowding
\item Color coding by functional categories or enrichment strength
\item Point sizing by enrichment metrics
\item Flexible y-axis transformations
}
}
\examples{
\dontrun{
# Basic functional Manhattan plot
con <- connect_funseq_db("analysis.db")
enrich_res <- run_go_enrichment_workflow(con, "candidates.vcf")

# Prepare GEA results data frame
gea_data <- data.frame(
  chromosome = c("1", "1", "2", "3"),
  position = c(1000000, 2000000, 1500000, 800000),
  p_value = c(0.001, 0.0001, 0.005, 0.05)
)

# Create Manhattan plot
manhattan_plot <- create_functional_manhattan_plot(
  con, enrich_res$enrichment_results, enrich_res$candidate_import$file_id,
  gea_data, y_metric = "p_value"
)

print(manhattan_plot)

# Customize visualization
custom_plot <- create_functional_manhattan_plot(
  con, enrich_res$enrichment_results, enrich_res$candidate_import$file_id,
  gea_data,
  y_metric = "p_value",
  color_by = "fold_enrichment",
  point_size_by = "significance",
  max_labels = 10,
  title = "Environmental Association vs Functional Enrichment"
)
}

}
