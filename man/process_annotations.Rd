% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/process_annotations.R
\name{process_annotations}
\alias{process_annotations}
\title{Process Functional Annotations into Standardized Summary Table}
\usage{
process_annotations(
  con,
  include = c("GO", "KEGG", "Pfam", "InterPro", "eggNOG"),
  blast_param_id = NULL,
  export_csv = NULL,
  verbose = TRUE
)
}
\arguments{
\item{con}{Database connection object from annotate_blast_results()}

\item{include}{Character vector. Types of annotations to include: "GO", "KEGG", or both. Default is c("GO", "KEGG")}

\item{blast_param_id}{Integer. Optional. Specific BLAST parameter set to use. If NULL, uses all available annotations}

\item{export_csv}{Character. Optional. File path to export results as CSV}

\item{verbose}{Logical. Print progress information. Default is TRUE}
}
\value{
Data frame with standardized functional annotations:
\itemize{
\item locus_id: Unique identifier for each genomic locus
\item chromosome: Chromosome name
\item position: Genomic position
\item gene_name: Primary gene name (from UniProt)
\item protein_name: Protein description
\item uniprot_accession: UniProt accession number
\item go_terms: Semi-colon separated GO term IDs (if "GO" included)
\item go_names: Semi-colon separated GO term names (if "GO" included)
\item go_categories: Semi-colon separated GO categories (BP/MF/CC) (if "GO" included)
\item kegg_pathways: Semi-colon separated KEGG pathway IDs (if "KEGG" included)
\item kegg_pathway_names: Semi-colon separated KEGG pathway names (if "KEGG" included)
\item kegg_brite_categories: Semi-colon separated KEGG BRITE classifications (if "KEGG" included)
\item kegg_modules: Semi-colon separated KEGG module assignments (if "KEGG" included)
}
}
\description{
Processes functional annotation results from annotate_blast_results() into a
comprehensive, standardized data frame linking each locus to functional annotations.
Automatically applies name standardization using KEGGREST and includes KEGG BRITE
hierarchy and module classifications.
}
\details{
This function streamlines the functional annotation workflow by:

\enumerate{
\item \strong{Data Integration}: Combines genomic positions with functional annotations
\item \strong{GO Processing}: Extracts GO terms, names, and ontology categories
\item \strong{KEGG Enhancement}: Uses KEGGREST API to improve pathway names and classifications
\item \strong{KEGG BRITE Classification}: Maps pathways to official KEGG BRITE hierarchy
\item \strong{Module Assignment}: Assigns pathways to functional modules
\item \strong{Standardized Output}: Creates one comprehensive table for all downstream analyses
}

The resulting data frame can be used directly with enrichment analysis functions
or exported for external analysis tools.
}
\examples{
\dontrun{
# Complete workflow
blast_results <- run_blast(sequences, database)
con <- annotate_blast_results(blast_results)

# Process all annotations
annotations <- process_annotations(con, include = c("GO", "KEGG"))

# Process only KEGG annotations
kegg_only <- process_annotations(con, include = "KEGG")

# Export to CSV for external analysis
annotations <- process_annotations(
  con, 
  include = c("GO", "KEGG"),
  export_csv = "functional_annotations.csv"
)

# Use with enrichment analysis
go_enrichment <- run_go_enrichment_analysis(annotations, candidate_loci)
kegg_enrichment <- run_kegg_enrichment_analysis(annotations, candidate_loci)
}

}
